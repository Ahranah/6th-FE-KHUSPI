# KHUSPI 프로젝트 분석 및 확장 계획 (STAR 방식)

## 📌 프로젝트 개요
**KHUSPI 13 ETF 선정 및 예측 - 일별 뉴스 데이터 감성 점수 기반**

본 문서는 STAR(Situation, Task, Action, Result) 프레임워크를 활용하여 프로젝트를 분석하고 향후 확장 계획을 수립합니다.

---

## 1. Situation (상황) 🎯

### 1.1 프로젝트 배경
- **시장 상황**: 금융 시장에서 뉴스 데이터가 주가에 미치는 영향에 대한 관심 증가
- **기술적 배경**: 자연어처리(NLP) 및 딥러닝 기술의 발전으로 뉴스 감성 분석이 가능해짐
- **투자 환경**: 한국 주식시장의 섹터별 ETF 투자 수요 증가

### 1.2 프로젝트 범위
- **분석 기간**: 2023년 7월 1일 ~ 2024년 6월 30일 (1년간의 뉴스 데이터)
- **대상 섹터**: 13개 국내 섹터
  - 건설, 경기소비재, 기계장비, 반도체, 방송통신, 보험, 에너지화학, 은행, 자동차, 정보기술, 증권, 철강, 헬스케어

### 1.3 데이터 소스
| 데이터 유형 | 출처             | 설명                         |
|------------|------------------|------------------------------|
| 뉴스 데이터 | 한국경제 검색    | 섹터별 기업 관련 뉴스 제목   |
| 주가 데이터 | KRX              | 섹터별 지수 종가 데이터       |

### 1.4 기존 문제점/도전 과제
1. 뉴스 감성과 주가 변동 간의 상관관계 불명확
2. 섹터 간 뉴스 영향력의 교차 효과(Spillover Effect) 미탐구
3. 예측 모델의 정확도 및 신뢰성 검증 필요

---

## 2. Task (과제) 📋

### 2.1 핵심 목표
```
"특정 섹터의 뉴스 데이터 감성 점수가 다른 섹터의 지수 변동에 통계적으로 유의한 영향을 미치는지 분석하고, 
이를 기반으로 투자자의 성향에 맞는 섹터 자산군 유니버스를 구축한다."
```

### 2.2 세부 과제
| 순번 | 과제 | 설명 | 담당 노트북 |
|------|------|------|------------|
| 1 | 뉴스 데이터 수집 | 섹터별 기업 뉴스 크롤링 | `crawling_News_data.ipynb` |
| 2 | 감성 분석 | KLUE BERT 기반 뉴스 제목 감성 점수 산출 | `KLUE BERT_Sentiment.ipynb` |
| 3 | 감성 점수 집계 | 일별/섹터별 가중 평균 감성 점수 계산 | `Sentiment_score_avarage.ipynb` (주: 파일명 오타 있음) |
| 4 | 시계열 분석 | ARIMAX 모델로 감성-지수 관계 분석 | `ARIMAX_Sentiment.ipynb` |
| 5 | 예측 모델링 | LSTM+CNN+Attention 기반 수익률 예측 | `LSTM_CNN.ipynb` |
| 6 | 포트폴리오 최적화 | MVO(Mean-Variance Optimization) 적용 | `Portfolio_Optimization.ipynb` |

### 2.3 성공 기준
- [ ] 섹터 간 유의미한 감성-지수 상관관계 발견
- [ ] 예측 모델의 MAE < 0.01
- [ ] 백테스팅 결과 벤치마크 대비 초과 수익 달성

---

## 3. Action (행동) 🔧

### 3.1 데이터 수집 파이프라인
```
[기업 목록 Excel] → [한국경제 뉴스 검색 크롤링] → [일별 뉴스 제목 CSV 저장]
```

**주요 특징:**
- 기간별 순차 크롤링 (일 단위)
- 요청 간격 3초로 서버 부하 방지
- UTF-8-sig 인코딩으로 한글 호환성 확보

### 3.2 감성 분석 방법론

#### 3.2.1 KLUE BERT 감성 분류
```python
# 감성 레이블
- Positive (긍정)
- Neutral (중립)  
- Negative (부정)

# 출력 형태
- 각 클래스별 확률 (Softmax)
- 최종 감성 레이블
```

#### 3.2.2 감성 점수 계산
```
감성 점수 = P(Positive) - P(Negative)

설명:
- P(Positive): 긍정 확률
- P(Negative): 부정 확률
- P(Neutral): 중립 확률 (점수 계산에서 제외, 긍/부정의 상대적 강도에 집중)

범위: [-1, 1]
- 1에 가까울수록: 강한 긍정
- 0에 가까울수록: 중립적
- -1에 가까울수록: 강한 부정
```

### 3.3 시계열 분석 모델

#### 3.3.1 ARIMAX 모델
- **내생변수(Y)**: 섹터별 지수 수익률
- **외생변수(X)**: 섹터별 감성 점수
- **목적**: 감성 점수의 통계적 유의성 검증

#### 3.3.2 LSTM + CNN + Attention 모델
```
Input Layer
    │
    ▼
LSTM (100 units, return_sequences=True)
    │
    ▼
Attention Layer (Self-Attention)
    │
    ▼
Conv1D (64 filters, kernel_size=3)
    │
    ▼
GlobalMaxPooling1D
    │
    ▼
Dense (128 units) + Dropout (0.3)
    │
    ▼
Output Layer (1 unit - 수익률 예측)
```

### 3.4 포트폴리오 최적화

#### 3.4.1 최적 조합 선정 기준
- ARIMAX 분석에서 통계적 유의성(p-value < 0.05) 확인된 섹터 조합

#### 3.4.2 포트폴리오 구성 방법
1. **동일 가중치 포트폴리오**: 각 자산에 균등 배분
2. **MVO(Mean-Variance Optimization)**: 샤프 비율 최대화

### 3.5 백테스팅 전략
```python
# 매매 규칙
if predicted_return > 0:
    매수 (전체 자본 투자)
elif predicted_return < 0 and holdings > 0:
    매도

# 거래 비용
transaction_fee = 0.1% (0.001)
```

---

## 4. Result (결과) 📊

### 4.1 주요 발견

#### 4.1.1 섹터 간 교차 영향 관계
| Score Sector (감성) | Price Sector (지수) | 예측 수익률 | 실제 수익률 |
|---------------------|---------------------|-------------|-------------|
| 건설 | 보험 | 0.0003 | 0.0015 |
| 건설 | 자동차 | 0.0005 | 0.0014 |
| 경기소비재 | 반도체 | 0.0012 | 0.0004 |
| 경기소비재 | 보험 | 0.0020 | 0.0015 |
| 보험 | 은행 | 0.0017 | 0.0039 |
| 보험 | 자동차 | 0.0015 | 0.0014 |
| 에너지화학 | 기계장비 | 0.0012 | -0.0026 |

#### 4.1.2 포트폴리오 성과 (2024년 4월 26일 기준)
| 섹터 | 포트폴리오 수익률 |
|------|------------------|
| 건설 | 0.1450% |
| 경기소비재 | 0.1520% |
| 보험 | 0.1417% |
| 은행 | 0.1450% |
| 헬스케어 | 0.0900% |

#### 4.1.3 모델 성능
```
LSTM+CNN+Attention 모델:
- Training MAE: ~0.01
- Validation Loss: Converged after 20 epochs

백테스팅 결과:
- Strategy Average Return: -0.0003
- Strategy Volatility: 0.0169
- Buy-and-Hold Average Return: 0.0005
- Buy-and-Hold Volatility: 0.0182
```

### 4.2 핵심 인사이트

1. **섹터 간 Spillover Effect 확인**
   - 특정 섹터의 뉴스 감성이 다른 섹터의 지수 변동에 통계적으로 유의한 영향
   - 예: 건설 섹터 뉴스 → 보험/자동차 섹터 지수 영향

2. **감성 점수의 예측력**
   - ARIMAX 외생변수로서 감성 점수의 유의성 확인
   - 단, 단기 예측에서 정확도 향상 필요

3. **포트폴리오 전략의 한계**
   - 예측 기반 전략이 단순 Buy-and-Hold 대비 낮은 수익률
   - 거래 비용 및 시장 마찰 비용 고려 필요

---

## 5. 확장 계획 🚀

### 5.1 단기 개선 사항 (1-3개월)

#### 5.1.1 데이터 품질 개선
| 개선 항목 | 현재 상태 | 개선 방안 |
|----------|----------|----------|
| 뉴스 소스 | 한국경제만 | 다중 매체 (네이버, 다음, 연합뉴스 등) |
| 뉴스 내용 | 제목만 분석 | 본문 포함 분석 |
| 데이터 기간 | 1년 | 3-5년으로 확장 |

#### 5.1.2 감성 분석 모델 개선
```python
# 현재: KLUE BERT (일반 감성 분류)
# 개선: 금융 특화 감성 분석 모델
- KR-FinBERT 적용
- 금융 용어 사전 구축
- 긍/부정 강도(intensity) 반영
```

### 5.2 중기 개선 사항 (3-6개월)

#### 5.2.1 예측 모델 고도화
```
1. Transformer 기반 시계열 예측
   - Temporal Fusion Transformer (TFT)
   - Informer (Long Sequence Time-Series)

2. 앙상블 학습
   - LSTM + GRU + Transformer
   - Gradient Boosting (LightGBM, XGBoost)

3. 멀티태스크 학습
   - 수익률 + 변동성 동시 예측
```

#### 5.2.2 실시간 데이터 파이프라인 구축
```
[뉴스 API] → [실시간 크롤링] → [감성 분석] → [신호 생성] → [알림 시스템]
```

### 5.3 장기 비전 (6개월-1년)

#### 5.3.1 시스템 아키텍처 확장
```
┌─────────────────────────────────────────────────────────────┐
│                      KHUSPI 2.0 시스템                       │
├─────────────────────────────────────────────────────────────┤
│  Data Layer                                                  │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │  뉴스   │ │  소셜   │ │  공시   │ │  매크로 │           │
│  │  데이터 │ │  미디어 │ │  데이터 │ │  지표   │           │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
│                      │                                       │
│  ┌───────────────────▼───────────────────┐                 │
│  │         Feature Engineering           │                  │
│  │  - 감성 점수                          │                  │
│  │  - 기술적 지표                        │                  │
│  │  - 매크로 변수                        │                  │
│  └───────────────────┬───────────────────┘                 │
│                      │                                       │
│  ┌───────────────────▼───────────────────┐                 │
│  │         Prediction Engine             │                  │
│  │  - Multi-Model Ensemble               │                  │
│  │  - Uncertainty Quantification         │                  │
│  └───────────────────┬───────────────────┘                 │
│                      │                                       │
│  ┌───────────────────▼───────────────────┐                 │
│  │         Portfolio Optimizer           │                  │
│  │  - Risk Parity                        │                  │
│  │  - Black-Litterman                    │                  │
│  └───────────────────┬───────────────────┘                 │
│                      │                                       │
│  ┌───────────────────▼───────────────────┐                 │
│  │         Execution & Monitoring        │                  │
│  │  - Paper Trading                      │                  │
│  │  - Performance Dashboard              │                  │
│  └───────────────────────────────────────┘                 │
└─────────────────────────────────────────────────────────────┘
```

#### 5.3.2 추가 데이터 소스 통합
| 데이터 유형 | 활용 방안 |
|------------|----------|
| 소셜 미디어 | 투자자 심리 지수 |
| 공시 데이터 | 이벤트 기반 트레이딩 |
| 매크로 지표 | 경기 사이클 반영 |
| 옵션/선물 | 변동성 예측 |

#### 5.3.3 리스크 관리 강화
```python
# 구현 예정 기능
1. VaR (Value at Risk) 계산
2. Maximum Drawdown 모니터링
3. 포지션 사이징 최적화
4. Stop-Loss / Take-Profit 자동화
```

### 5.4 기술 스택 업그레이드 계획

| 영역 | 현재 | 계획 |
|------|------|------|
| 데이터 저장 | CSV 파일 | PostgreSQL + TimescaleDB |
| 데이터 처리 | Pandas | Apache Spark / Dask |
| 모델 서빙 | Jupyter Notebook | FastAPI + MLflow |
| 배포 | 로컬 | Docker + Kubernetes |
| 모니터링 | 수동 | Grafana + Prometheus |

---

## 6. 결론 및 제언 💡

### 6.1 프로젝트 의의
- 뉴스 감성 데이터를 활용한 섹터 간 교차 영향 관계 실증 분석
- ARIMAX + Deep Learning 하이브리드 접근법의 적용
- 포트폴리오 최적화를 통한 실용적 투자 전략 제시

### 6.2 한계점
1. **데이터 제한**: 단일 뉴스 소스, 1년 데이터
2. **모델 성능**: 예측 정확도 개선 필요
3. **시장 마찰**: 실제 거래 비용 및 슬리피지 미반영

### 6.3 향후 연구 방향
1. 금융 특화 LLM(Large Language Model) 활용
2. 강화학습(RL) 기반 동적 포트폴리오 조정
3. 글로벌 시장으로의 확장 (미국, 유럽 등)

---

## 부록: 파일 구조

```
6th-FE-KHUSPI/
├── README.md                        # 프로젝트 개요
├── PROJECT_ANALYSIS_STAR.md         # STAR 분석 문서 (현재 문서)
├── crawling_News_data.ipynb         # 뉴스 데이터 크롤링
├── KLUE BERT_Sentiment.ipynb        # KLUE BERT 감성 분석
├── Sentiment_score_avarage.ipynb    # 감성 점수 집계 (파일명 오타: average의 오기)
├── ARIMAX_Sentiment.ipynb           # ARIMAX 시계열 분석
├── LSTM_CNN.ipynb                   # LSTM+CNN 예측 모델
└── Portfolio_Optimization.ipynb     # 포트폴리오 최적화
```

---

*문서 작성일: 2024년 12월*  
*프로젝트: KHUSPI 13 ETF 선정 및 예측*  
*분석 방법론: STAR Framework*
